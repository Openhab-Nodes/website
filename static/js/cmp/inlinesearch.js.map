{"version":3,"file":"inlinesearch.js","sources":["../../../assets/js/inlinesearch/popover_helper.js","../../../assets/js/inlinesearch/index.js"],"sourcesContent":["\nfunction isInViewport(element) {\n  const rect = element.getBoundingClientRect();\n  const html = document.documentElement;\n  return rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= (window.innerHeight || html.clientHeight) &&\n    rect.right <= (window.innerWidth || html.clientWidth);\n}\n\nclass Popover {\n  constructor(trigger, popoverTemplate, { position = 'top', className = 'popover' }) {\n    this.trigger = trigger;\n    this.position = position;\n    this.className = className;\n    this.isTemplate = false;\n    this.orderedPositions = ['top', 'right', 'bottom', 'left'];\n\n    this.isTemplate = popoverTemplate.tagName.toUpperCase() == \"TEMPLATE\";\n    if (this.isTemplate) {\n      this.popover = document.createElement('div');\n      this.popover.innerHTML = popoverTemplate.innerHTML;\n    } else {\n      this.popover = popoverTemplate;\n    }\n    this.popover.style.zIndex = 100;\n\n    Object.assign(this.popover.style, {\n      position: 'fixed'\n    });\n\n    this.popover.classList.add(className);\n\n    this.handleWindowEvent = () => {\n      if (this.isVisible) {\n        this.reposition();\n      }\n    };\n\n    this.handleDocumentEvent = (evt) => {\n      if (this.isVisible && evt.target !== this.trigger && evt.target !== this.popover) {\n        this.destroy();\n      }\n    };\n  }\n\n  get isVisible() {\n    return this.isTemplate ? document.body.contains(this.popover) : this.popover.style.visibility !== \"hidden\";\n  }\n\n  show() {\n    if (this.isVisible) return;\n\n    document.addEventListener('click', this.handleDocumentEvent);\n    window.addEventListener('scroll', this.handleWindowEvent);\n    window.addEventListener('resize', this.handleWindowEvent);\n\n    if (this.isTemplate)\n      document.body.appendChild(this.popover);\n    else {\n      this.popover.style.setProperty('visibility', 'visible', 'important');\n    }\n\n    this.reposition();\n  }\n\n  reposition() {\n    const { top: triggerTop, left: triggerLeft } = this.trigger.getBoundingClientRect();\n    const { offsetHeight: triggerHeight, offsetWidth: triggerWidth } = this.trigger;\n    const { offsetHeight: popoverHeight, offsetWidth: popoverWidth } = this.popover;\n\n    const positionIndex = this.orderedPositions.indexOf(this.position);\n\n    const positions = {\n      top: {\n        name: 'top',\n        top: triggerTop - popoverHeight,\n        left: triggerLeft - ((popoverWidth - triggerWidth) / 2)\n      },\n      right: {\n        name: 'right',\n        top: triggerTop - ((popoverHeight - triggerHeight) / 2),\n        left: triggerLeft + triggerWidth\n      },\n      bottom: {\n        name: 'bottom',\n        top: triggerTop + triggerHeight,\n        left: triggerLeft - ((popoverWidth - triggerWidth) / 2)\n      },\n      left: {\n        name: 'left',\n        top: triggerTop - ((popoverHeight - triggerHeight) / 2),\n        left: triggerLeft - popoverWidth\n      }\n    };\n\n    const position = this.orderedPositions\n      .slice(positionIndex)\n      .concat(this.orderedPositions.slice(0, positionIndex))\n      .map(pos => positions[pos])\n      .find(pos => {\n        this.popover.style.top = `${pos.top}px`;\n        this.popover.style.left = `${pos.left}px`;\n        return isInViewport(this.popover);\n      });\n\n    this.orderedPositions.forEach(pos => {\n      this.popover.classList.remove(`${this.className}--${pos}`);\n    });\n\n    if (position) {\n      this.popover.classList.add(`${this.className}--${position.name}`);\n    } else {\n      this.popover.style.top = positions.bottom.top;\n      this.popover.style.left = positions.bottom.left;\n      this.popover.classList.add(`${this.className}--bottom`);\n    }\n  }\n\n  destroy() {\n    if (this.isTemplate)\n      this.popover.remove();\n    else\n      this.popover.style.setProperty('visibility', 'hidden', 'important');\n\n    document.removeEventListener('click', this.handleDocumentEvent);\n    window.removeEventListener('scroll', this.handleWindowEvent);\n    window.removeEventListener('resize', this.handleWindowEvent);\n  }\n\n  toggle() {\n    if (this.isVisible) {\n      this.destroy();\n    } else {\n      this.show();\n    }\n  }\n}\n\nexport { Popover };","import { Popover } from \"./popover_helper.js\";\n\nfunction tmpContents(link, title, tags, categories, snippet) {\n    return `\n    <div class=\"search-results-summary\">\n        <h4>${title}</h4>\n        <p>${snippet}  &hellip; <a class=\"search-item-more\" href=\"${link}\">[more]</a></p>\n        ${ tags != null ? `<p>${tags}</p>` : ''}\n    </div>\n    `;\n}\nfunction tmpTitle(link, title, tags, categories, summary) {\n    return `\n    <div class=\"search-results-summary\">\n        <h4><a class=\"search-item\" href=\"${link}\">${title}</a></h4>\n        ${ summary.length ? `<p>${summary} &hellip;</p>` : ''}\n        ${ tags != null ? `<p>${tags}</p>` : ''}\n    </div>\n    `;\n}\n\nconst summaryInclude = 60;\nconst fuseOptions = {\n    shouldSort: true,\n    includeMatches: true,\n    threshold: 0.3,\n    tokenize: false,\n    location: 0,\n    distance: 100,\n    maxPatternLength: 32,\n    minMatchCharLength: 2,\n    keys: [\n        { name: \"title\", weight: 0.8 },\n        { name: \"contents\", weight: 0.5 },\n        { name: \"tags\", weight: 0.3 },\n        //{ name: \"categories\", weight: 0.3 }\n    ]\n};\n\nwindow.customElements.define('ui-inlinesearch', class extends HTMLElement {\n    constructor() {\n        super();\n    }\n\n    clear(resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages) {\n        while (resultshtml.firstChild) {\n            resultshtml.firstChild.remove();\n        }\n        while (resultshtmltags.firstChild) {\n            resultshtmltags.firstChild.remove();\n        }\n        while (resultshtmlfulltext.firstChild) {\n            resultshtmlfulltext.firstChild.remove();\n        }\n        while (resultshtmlpages.firstChild) {\n            resultshtmlpages.firstChild.remove();\n        }\n    }\n\n    renderResult(result, maxresults_, startPage, resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages) {\n        const startIndex = startPage * maxresults_;\n        const maxresults = startIndex + maxresults_;\n        let entryTags = null;\n\n        let foundcontents = 0;\n        let foundtags = [];\n\n        for (let entry of result) {\n            for (let mvalue of entry.matches) {\n                if (!entryTags && entry.item.tags) {\n                    entryTags = \"\";\n                    for (let element of entry.item.tags) {\n                        entryTags = entryTags + \"<a href='/tags/\" + element + \"'>\" + \"#\" + element + \"</a> \"\n                    };\n                }\n\n                if (mvalue.key === \"contents\") {\n                    ++foundcontents;\n                    if (foundcontents-1 < startIndex) continue;\n                    if (foundcontents > maxresults) continue;\n\n                    //console.log(\"contents\",mvalue);\n                    let resultPart = document.createElement(\"div\");\n                    const start = mvalue.indices[0][0] - summaryInclude > 0 ? mvalue.indices[0][0] - summaryInclude : 0;\n                    const end = mvalue.indices[0][1] + summaryInclude < entry.item.contents.length ? mvalue.indices[0][1] + summaryInclude : entry.item.contents.length;\n                    let snippet = entry.item.contents.substring(start, end);\n                    resultPart.innerHTML = tmpContents(entry.item.permalink,\n                        entry.item.title, entryTags, entry.item.categories, snippet);\n                    resultshtmlfulltext.appendChild(resultPart);\n                } else if (mvalue.key === \"tags\") {\n                    foundtags.push(mvalue.value);\n                } else if (mvalue.key === \"title\") {\n                    ++foundcontents;\n                    if (foundcontents-1 < startIndex) continue;\n                    if (foundcontents > maxresults) continue;\n\n                    let resultPart = document.createElement(\"div\");\n                    resultPart.innerHTML = tmpTitle(entry.item.permalink,\n                        entry.item.title, entryTags, entry.item.categories, entry.item.contents.substring(0, summaryInclude));\n                    resultshtml.appendChild(resultPart);\n                }\n            }\n            entryTags = null;\n        }\n\n        entryTags = \"\";\n        for (let element of foundtags) {\n            entryTags = entryTags + \"<a href='/tags/\" + element + \"'>\" + \"#\" + element + \"</a> \"\n        };\n        resultshtmltags.innerHTML = entryTags;\n\n        let pages = foundcontents / maxresults_;\n        if (pages > 1) {\n            for (let c = 0; c < pages; ++c) {\n                const link = document.createElement(\"a\");\n                link.innerText = c;\n                if (c != startPage) {\n                    link.href = \"?s=\" + c * maxresults_;\n                    link.onclick = (e) => {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        this.clear(resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n                        this.renderResult(result, maxresults_, c, resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n                    }\n                }\n                link.classList.add(\"m-1\", \"border\", \"px-2\");\n                resultshtmlpages.appendChild(link);\n            }\n        }\n    }\n\n    init() {\n        let target = document.getElementById(this.getAttribute(\"target\"));\n\n        const popoverTemplate = document.createElement('template');\n        popoverTemplate.innerHTML = `\n        <div class=\"card p-1 mb-2\">Document Titles</div><div id=\"search-results\"></div>\n        <div class=\"card p-1 mb-2\">Fulltext matches</div><div id=\"search-results-fulltext\"></div>\n        <div class=\"card p-1 mb-2\">Tags</div><div id=\"search-results-tags\"></div>\n        <div id=\"search-results-pages\"></div>\n        `;\n\n        if (!target) {\n            console.warn(\"Did not find target: \", target);\n            return;\n        }\n        if (!popoverTemplate) {\n            console.warn(\"Did not find template for \", target.id);\n            return;\n        }\n\n        const input = target.querySelector(\"input\");\n        if (!input) {\n            console.warn(\"Did not find input for \", target.id);\n            return;\n        }\n        //console.log(\"INIT\", input);\n\n        if (this.popover) this.popover.destroy();\n        this.popover = new Popover(target, popoverTemplate, { position: 'bottom' });\n\n        this.lastresultlen = 0;\n        target.action = \"#\";\n        target.onsubmit = (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        }\n        const maxresults = 5;\n        input.onmouseup = () => {\n            window.requestAnimationFrame(() => {\n                this.popover.show();\n            })\n        };\n        input.onkeyup = (e) => {\n            this.popover.show();\n            var result = input.value.length ? this.fuse.search(input.value) : [];\n            const resultshtml = this.popover.popover.querySelector(\"#search-results\");\n            const resultshtmltags = this.popover.popover.querySelector(\"#search-results-tags\");\n            const resultshtmlfulltext = this.popover.popover.querySelector(\"#search-results-fulltext\");\n            const resultshtmlpages = this.popover.popover.querySelector(\"#search-results-pages\");\n            this.clear(resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n            if (result.length > 0) {\n                this.renderResult(result, maxresults, 0, resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n            } else if (this.lastresultlen != 0) {\n                resultshtml.innerHTML = `<p class=\\\"search-results-empty\\\">No matches found</p>`\n            }\n            this.lastresultlen = result.length;\n        }\n    }\n\n    async connectedCallback() {\n        let index = \"\";\n        if (this.hasAttribute(\"index\")) index = \"/\"+ this.getAttribute(\"index\");\n        let imp = import('/js/fuse.min.js');\n        let jsonindex = await fetch(index+\"/index.json\");\n        let Fuse = await imp;\n        Fuse = Fuse.default();\n        jsonindex = await jsonindex.json();\n        this.fuse = new Fuse(jsonindex, fuseOptions);\n        this.init();\n    }\n    disconnectedCallback() {\n        if (this.popover) this.popover.destroy();\n    }\n});\n"],"names":["Popover","[object Object]","trigger","popoverTemplate","position","className","this","isTemplate","orderedPositions","tagName","toUpperCase","popover","document","createElement","innerHTML","style","zIndex","Object","assign","classList","add","handleWindowEvent","isVisible","reposition","handleDocumentEvent","evt","target","destroy","body","contains","visibility","addEventListener","window","appendChild","setProperty","top","triggerTop","left","triggerLeft","getBoundingClientRect","offsetHeight","triggerHeight","offsetWidth","triggerWidth","popoverHeight","popoverWidth","positionIndex","indexOf","positions","name","right","bottom","slice","concat","map","pos","find","element","rect","html","documentElement","innerHeight","clientHeight","innerWidth","clientWidth","isInViewport","forEach","remove","removeEventListener","show","tmpContents","link","title","tags","categories","snippet","fuseOptions","shouldSort","includeMatches","threshold","tokenize","location","distance","maxPatternLength","minMatchCharLength","keys","weight","customElements","define","HTMLElement","super","resultshtml","resultshtmltags","resultshtmlfulltext","resultshtmlpages","firstChild","result","maxresults_","startPage","startIndex","maxresults","entryTags","foundcontents","foundtags","entry","mvalue","matches","item","key","resultPart","start","indices","end","contents","length","substring","permalink","push","value","summary","pages","c","innerText","href","onclick","e","preventDefault","stopPropagation","clear","renderResult","getElementById","getAttribute","console","warn","id","input","querySelector","lastresultlen","action","onsubmit","onmouseup","requestAnimationFrame","onkeyup","fuse","search","index","hasAttribute","imp","import","jsonindex","fetch","Fuse","default","json","init"],"mappings":"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"}