{"version":3,"file":"inlinesearch.js","sources":["../../../assets/js/inlinesearch/popover_helper.js","../../../assets/js/inlinesearch/index.js"],"sourcesContent":["\nfunction isInViewport(element) {\n  const rect = element.getBoundingClientRect();\n  const html = document.documentElement;\n  return rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= (window.innerHeight || html.clientHeight) &&\n    rect.right <= (window.innerWidth || html.clientWidth);\n}\n\nclass Popover {\n  constructor(trigger, popoverTemplate, { position = 'top', className = 'popover' }) {\n    this.trigger = trigger;\n    this.position = position;\n    this.className = className;\n    this.isTemplate = false;\n    this.orderedPositions = ['top', 'right', 'bottom', 'left'];\n\n    this.isTemplate = popoverTemplate.tagName.toUpperCase() == \"TEMPLATE\";\n    if (this.isTemplate) {\n      this.popover = document.createElement('div');\n      this.popover.innerHTML = popoverTemplate.innerHTML;\n    } else {\n      this.popover = popoverTemplate;\n    }\n    this.popover.style.zIndex = 100;\n\n    Object.assign(this.popover.style, {\n      position: 'fixed'\n    });\n\n    this.popover.classList.add(className);\n\n    this.handleWindowEvent = () => {\n      if (this.isVisible) {\n        this.reposition();\n      }\n    };\n\n    this.handleDocumentEvent = (evt) => {\n      if (this.isVisible && evt.target !== this.trigger && evt.target !== this.popover) {\n        this.destroy();\n      }\n    };\n  }\n\n  get isVisible() {\n    return this.isTemplate ? document.body.contains(this.popover) : this.popover.style.visibility !== \"hidden\";\n  }\n\n  show() {\n    if (this.isVisible) return;\n\n    document.addEventListener('click', this.handleDocumentEvent);\n    window.addEventListener('scroll', this.handleWindowEvent);\n    window.addEventListener('resize', this.handleWindowEvent);\n\n    if (this.isTemplate)\n      document.body.appendChild(this.popover);\n    else {\n      this.popover.style.setProperty('visibility', 'visible', 'important');\n    }\n\n    this.reposition();\n  }\n\n  reposition() {\n    const { top: triggerTop, left: triggerLeft } = this.trigger.getBoundingClientRect();\n    const { offsetHeight: triggerHeight, offsetWidth: triggerWidth } = this.trigger;\n    const { offsetHeight: popoverHeight, offsetWidth: popoverWidth } = this.popover;\n\n    const positionIndex = this.orderedPositions.indexOf(this.position);\n\n    const positions = {\n      top: {\n        name: 'top',\n        top: triggerTop - popoverHeight,\n        left: triggerLeft - ((popoverWidth - triggerWidth) / 2)\n      },\n      right: {\n        name: 'right',\n        top: triggerTop - ((popoverHeight - triggerHeight) / 2),\n        left: triggerLeft + triggerWidth\n      },\n      bottom: {\n        name: 'bottom',\n        top: triggerTop + triggerHeight,\n        left: triggerLeft - ((popoverWidth - triggerWidth) / 2)\n      },\n      left: {\n        name: 'left',\n        top: triggerTop - ((popoverHeight - triggerHeight) / 2),\n        left: triggerLeft - popoverWidth\n      }\n    };\n\n    const position = this.orderedPositions\n      .slice(positionIndex)\n      .concat(this.orderedPositions.slice(0, positionIndex))\n      .map(pos => positions[pos])\n      .find(pos => {\n        this.popover.style.top = `${pos.top}px`;\n        this.popover.style.left = `${pos.left}px`;\n        return isInViewport(this.popover);\n      });\n\n    this.orderedPositions.forEach(pos => {\n      this.popover.classList.remove(`${this.className}--${pos}`);\n    });\n\n    if (position) {\n      this.popover.classList.add(`${this.className}--${position.name}`);\n    } else {\n      this.popover.style.top = positions.bottom.top;\n      this.popover.style.left = positions.bottom.left;\n      this.popover.classList.add(`${this.className}--bottom`);\n    }\n  }\n\n  destroy() {\n    if (this.isTemplate)\n      this.popover.remove();\n    else\n      this.popover.style.setProperty('visibility', 'hidden', 'important');\n\n    document.removeEventListener('click', this.handleDocumentEvent);\n    window.removeEventListener('scroll', this.handleWindowEvent);\n    window.removeEventListener('resize', this.handleWindowEvent);\n  }\n\n  toggle() {\n    if (this.isVisible) {\n      this.destroy();\n    } else {\n      this.show();\n    }\n  }\n}\n\nexport { Popover };","import { Popover } from \"./popover_helper.js\";\n\nfunction tmpContents(link, title, tags, categories, snippet) {\n    return `\n    <div class=\"search-results-summary\">\n        <h4>${title}</h4>\n        <p>${snippet}  &hellip; <a class=\"search-item-more\" href=\"${link}\">[more]</a></p>\n        ${ tags != null ? `<p>${tags}</p>` : ''}\n    </div>\n    `;\n}\nfunction tmpTitle(link, title, tags, categories, summary) {\n    return `\n    <div class=\"search-results-summary\">\n        <h4><a class=\"search-item\" href=\"${link}\">${title}</a></h4>\n        ${ summary.length ? `<p>${summary} &hellip;</p>` : ''}\n        ${ tags != null ? `<p>${tags}</p>` : ''}\n    </div>\n    `;\n}\n\nconst summaryInclude = 60;\nconst fuseOptions = {\n    shouldSort: true,\n    includeMatches: true,\n    threshold: 0.3,\n    tokenize: false,\n    location: 0,\n    distance: 100,\n    maxPatternLength: 32,\n    minMatchCharLength: 2,\n    keys: [\n        { name: \"title\", weight: 0.8 },\n        { name: \"contents\", weight: 0.5 },\n        { name: \"tags\", weight: 0.3 },\n        //{ name: \"categories\", weight: 0.3 }\n    ]\n};\n\nwindow.customElements.define('ui-inlinesearch', class extends HTMLElement {\n    constructor() {\n        super();\n    }\n\n    clear(resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages) {\n        while (resultshtml.firstChild) {\n            resultshtml.firstChild.remove();\n        }\n        while (resultshtmltags.firstChild) {\n            resultshtmltags.firstChild.remove();\n        }\n        while (resultshtmlfulltext.firstChild) {\n            resultshtmlfulltext.firstChild.remove();\n        }\n        while (resultshtmlpages.firstChild) {\n            resultshtmlpages.firstChild.remove();\n        }\n    }\n\n    renderResult(result, maxresults_, startPage, resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages) {\n        const startIndex = startPage * maxresults_;\n        const maxresults = startIndex + maxresults_;\n        let entryTags = null;\n\n        let foundcontents = 0;\n        let foundtags = [];\n\n        for (let entry of result) {\n            for (let mvalue of entry.matches) {\n                if (!entryTags && entry.item.tags) {\n                    entryTags = \"\";\n                    for (let element of entry.item.tags) {\n                        entryTags = entryTags + \"<a href='/tags/\" + element + \"'>\" + \"#\" + element + \"</a> \"\n                    };\n                }\n\n                if (mvalue.key === \"contents\") {\n                    ++foundcontents;\n                    if (foundcontents-1 < startIndex) continue;\n                    if (foundcontents > maxresults) continue;\n\n                    //console.log(\"contents\",mvalue);\n                    let resultPart = document.createElement(\"div\");\n                    const start = mvalue.indices[0][0] - summaryInclude > 0 ? mvalue.indices[0][0] - summaryInclude : 0;\n                    const end = mvalue.indices[0][1] + summaryInclude < entry.item.contents.length ? mvalue.indices[0][1] + summaryInclude : entry.item.contents.length;\n                    let snippet = entry.item.contents.substring(start, end);\n                    resultPart.innerHTML = tmpContents(entry.item.permalink,\n                        entry.item.title, entryTags, entry.item.categories, snippet);\n                    resultshtmlfulltext.appendChild(resultPart);\n                } else if (mvalue.key === \"tags\") {\n                    foundtags.push(mvalue.value);\n                } else if (mvalue.key === \"title\") {\n                    ++foundcontents;\n                    if (foundcontents-1 < startIndex) continue;\n                    if (foundcontents > maxresults) continue;\n\n                    let resultPart = document.createElement(\"div\");\n                    resultPart.innerHTML = tmpTitle(entry.item.permalink,\n                        entry.item.title, entryTags, entry.item.categories, entry.item.contents.substring(0, summaryInclude));\n                    resultshtml.appendChild(resultPart);\n                }\n            }\n            entryTags = null;\n        }\n\n        entryTags = \"\";\n        for (let element of foundtags) {\n            entryTags = entryTags + \"<a href='/tags/\" + element + \"'>\" + \"#\" + element + \"</a> \"\n        };\n        resultshtmltags.innerHTML = entryTags;\n\n        let pages = foundcontents / maxresults_;\n        if (pages > 1) {\n            for (let c = 0; c < pages; ++c) {\n                const link = document.createElement(\"a\");\n                link.innerText = c;\n                if (c != startPage) {\n                    link.href = \"?s=\" + c * maxresults_;\n                    link.onclick = (e) => {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        this.clear(resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n                        this.renderResult(result, maxresults_, c, resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n                    }\n                }\n                link.classList.add(\"m-1\", \"border\", \"px-2\");\n                resultshtmlpages.appendChild(link);\n            }\n        }\n    }\n\n    init() {\n        let target = document.getElementById(this.getAttribute(\"target\"));\n\n        const popoverTemplate = document.createElement('template');\n        popoverTemplate.innerHTML = `\n        <div class=\"card p-1 mb-2\">Document Titles</div><div id=\"search-results\"></div>\n        <div class=\"card p-1 mb-2\">Fulltext matches</div><div id=\"search-results-fulltext\"></div>\n        <div class=\"card p-1 mb-2\">Tags</div><div id=\"search-results-tags\"></div>\n        <div id=\"search-results-pages\"></div>\n        `;\n\n        if (!target) {\n            console.warn(\"Did not find target: \", target);\n            return;\n        }\n        if (!popoverTemplate) {\n            console.warn(\"Did not find template for \", target.id);\n            return;\n        }\n\n        const input = target.querySelector(\"input\");\n        if (!input) {\n            console.warn(\"Did not find input for \", target.id);\n            return;\n        }\n        //console.log(\"INIT\", input);\n\n        if (this.popover) this.popover.destroy();\n        this.popover = new Popover(target, popoverTemplate, { position: 'bottom' });\n\n        this.lastresultlen = 0;\n        target.action = \"#\";\n        target.onsubmit = (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        }\n        const maxresults = 5;\n        input.onmouseup = () => {\n            window.requestAnimationFrame(() => {\n                this.popover.show();\n            })\n        };\n        input.onkeyup = (e) => {\n            this.popover.show();\n            var result = input.value.length ? this.fuse.search(input.value) : [];\n            const resultshtml = this.popover.popover.querySelector(\"#search-results\");\n            const resultshtmltags = this.popover.popover.querySelector(\"#search-results-tags\");\n            const resultshtmlfulltext = this.popover.popover.querySelector(\"#search-results-fulltext\");\n            const resultshtmlpages = this.popover.popover.querySelector(\"#search-results-pages\");\n            this.clear(resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n            if (result.length > 0) {\n                this.renderResult(result, maxresults, 0, resultshtml, resultshtmltags, resultshtmlfulltext, resultshtmlpages);\n            } else if (this.lastresultlen != 0) {\n                resultshtml.innerHTML = `<p class=\\\"search-results-empty\\\">No matches found</p>`\n            }\n            this.lastresultlen = result.length;\n        }\n    }\n\n    async connectedCallback() {\n        let index = \"\";\n        if (this.hasAttribute(\"index\")) index = \"/\"+ this.getAttribute(\"index\");\n        let imp = import('/js/fuse.min.js');\n        let jsonindex = await fetch(index+\"/index.json\");\n        let Fuse = await imp;\n        Fuse = Fuse.default();\n        jsonindex = await jsonindex.json();\n        this.fuse = new Fuse(jsonindex, fuseOptions);\n        this.init();\n    }\n    disconnectedCallback() {\n        if (this.popover) this.popover.destroy();\n    }\n});\n"],"names":[],"mappings":"AACA,SAAS,YAAY,CAAC,OAAO,EAAE;EAC7B,MAAM,IAAI,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;EAC7C,MAAM,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC;EACtC,OAAO,IAAI,CAAC,GAAG,IAAI,CAAC;IAClB,IAAI,CAAC,IAAI,IAAI,CAAC;IACd,IAAI,CAAC,MAAM,KAAK,MAAM,CAAC,WAAW,IAAI,IAAI,CAAC,YAAY,CAAC;IACxD,IAAI,CAAC,KAAK,KAAK,MAAM,CAAC,UAAU,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC;CACzD;;AAED,MAAM,OAAO,CAAC;EACZ,WAAW,CAAC,OAAO,EAAE,eAAe,EAAE,EAAE,QAAQ,GAAG,KAAK,EAAE,SAAS,GAAG,SAAS,EAAE,EAAE;IACjF,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACvB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IACzB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC3B,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;IACxB,IAAI,CAAC,gBAAgB,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;;IAE3D,IAAI,CAAC,UAAU,GAAG,eAAe,CAAC,OAAO,CAAC,WAAW,EAAE,IAAI,UAAU,CAAC;IACtE,IAAI,IAAI,CAAC,UAAU,EAAE;MACnB,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;MAC7C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,eAAe,CAAC,SAAS,CAAC;KACpD,MAAM;MACL,IAAI,CAAC,OAAO,GAAG,eAAe,CAAC;KAChC;IACD,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC;;IAEhC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;MAChC,QAAQ,EAAE,OAAO;KAClB,CAAC,CAAC;;IAEH,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;;IAEtC,IAAI,CAAC,iBAAiB,GAAG,MAAM;MAC7B,IAAI,IAAI,CAAC,SAAS,EAAE;QAClB,IAAI,CAAC,UAAU,EAAE,CAAC;OACnB;KACF,CAAC;;IAEF,IAAI,CAAC,mBAAmB,GAAG,CAAC,GAAG,KAAK;MAClC,IAAI,IAAI,CAAC,SAAS,IAAI,GAAG,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,EAAE;QAChF,IAAI,CAAC,OAAO,EAAE,CAAC;OAChB;KACF,CAAC;GACH;;EAED,IAAI,SAAS,GAAG;IACd,OAAO,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,KAAK,QAAQ,CAAC;GAC5G;;EAED,IAAI,GAAG;IACL,IAAI,IAAI,CAAC,SAAS,EAAE,OAAO;;IAE3B,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;IAC7D,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;IAC1D,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;;IAE1D,IAAI,IAAI,CAAC,UAAU;MACjB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACrC;MACH,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,YAAY,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC;KACtE;;IAED,IAAI,CAAC,UAAU,EAAE,CAAC;GACnB;;EAED,UAAU,GAAG;IACX,MAAM,EAAE,GAAG,EAAE,UAAU,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,qBAAqB,EAAE,CAAC;IACpF,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,WAAW,EAAE,YAAY,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;IAChF,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,WAAW,EAAE,YAAY,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;;IAEhF,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;IAEnE,MAAM,SAAS,GAAG;MAChB,GAAG,EAAE;QACH,IAAI,EAAE,KAAK;QACX,GAAG,EAAE,UAAU,GAAG,aAAa;QAC/B,IAAI,EAAE,WAAW,IAAI,CAAC,YAAY,GAAG,YAAY,IAAI,CAAC,CAAC;OACxD;MACD,KAAK,EAAE;QACL,IAAI,EAAE,OAAO;QACb,GAAG,EAAE,UAAU,IAAI,CAAC,aAAa,GAAG,aAAa,IAAI,CAAC,CAAC;QACvD,IAAI,EAAE,WAAW,GAAG,YAAY;OACjC;MACD,MAAM,EAAE;QACN,IAAI,EAAE,QAAQ;QACd,GAAG,EAAE,UAAU,GAAG,aAAa;QAC/B,IAAI,EAAE,WAAW,IAAI,CAAC,YAAY,GAAG,YAAY,IAAI,CAAC,CAAC;OACxD;MACD,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,GAAG,EAAE,UAAU,IAAI,CAAC,aAAa,GAAG,aAAa,IAAI,CAAC,CAAC;QACvD,IAAI,EAAE,WAAW,GAAG,YAAY;OACjC;KACF,CAAC;;IAEF,MAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB;OACnC,KAAK,CAAC,aAAa,CAAC;OACpB,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,EAAE,aAAa,CAAC,CAAC;OACrD,GAAG,CAAC,GAAG,IAAI,SAAS,CAAC,GAAG,CAAC,CAAC;OAC1B,IAAI,CAAC,GAAG,IAAI;QACX,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QACxC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC1C,OAAO,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;OACnC,CAAC,CAAC;;IAEL,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,GAAG,IAAI;MACnC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;KAC5D,CAAC,CAAC;;IAEH,IAAI,QAAQ,EAAE;MACZ,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;KACnE,MAAM;MACL,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC;MAC9C,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC;MAChD,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;KACzD;GACF;;EAED,OAAO,GAAG;IACR,IAAI,IAAI,CAAC,UAAU;MACjB,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;;MAEtB,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,CAAC,YAAY,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC;;IAEtE,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;IAChE,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;IAC7D,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;GAC9D;;EAED,MAAM,GAAG;IACP,IAAI,IAAI,CAAC,SAAS,EAAE;MAClB,IAAI,CAAC,OAAO,EAAE,CAAC;KAChB,MAAM;MACL,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;GACF;CACF;;ACvID,SAAS,WAAW,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,UAAU,EAAE,OAAO,EAAE;IACzD,OAAO,CAAC;;YAEA,EAAE,KAAK,CAAC;WACT,EAAE,OAAO,CAAC,6CAA6C,EAAE,IAAI,CAAC;QACjE,GAAG,IAAI,IAAI,IAAI,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;;IAE5C,CAAC,CAAC;CACL;AACD,SAAS,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,UAAU,EAAE,OAAO,EAAE;IACtD,OAAO,CAAC;;yCAE6B,EAAE,IAAI,CAAC,EAAE,EAAE,KAAK,CAAC;QAClD,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;QACtD,GAAG,IAAI,IAAI,IAAI,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;;IAE5C,CAAC,CAAC;CACL;;AAED,MAAM,cAAc,GAAG,EAAE,CAAC;AAC1B,MAAM,WAAW,GAAG;IAChB,UAAU,EAAE,IAAI;IAChB,cAAc,EAAE,IAAI;IACpB,SAAS,EAAE,GAAG;IACd,QAAQ,EAAE,KAAK;IACf,QAAQ,EAAE,CAAC;IACX,QAAQ,EAAE,GAAG;IACb,gBAAgB,EAAE,EAAE;IACpB,kBAAkB,EAAE,CAAC;IACrB,IAAI,EAAE;QACF,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,EAAE;QAC9B,EAAE,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE;QACjC,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE;;KAEhC;CACJ,CAAC;;AAEF,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,EAAE,cAAc,WAAW,CAAC;IACtE,WAAW,GAAG;QACV,KAAK,EAAE,CAAC;KACX;;IAED,KAAK,CAAC,WAAW,EAAE,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,EAAE;QACvE,OAAO,WAAW,CAAC,UAAU,EAAE;YAC3B,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;SACnC;QACD,OAAO,eAAe,CAAC,UAAU,EAAE;YAC/B,eAAe,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;SACvC;QACD,OAAO,mBAAmB,CAAC,UAAU,EAAE;YACnC,mBAAmB,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;SAC3C;QACD,OAAO,gBAAgB,CAAC,UAAU,EAAE;YAChC,gBAAgB,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;SACxC;KACJ;;IAED,YAAY,CAAC,MAAM,EAAE,WAAW,EAAE,SAAS,EAAE,WAAW,EAAE,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,EAAE;QAC9G,MAAM,UAAU,GAAG,SAAS,GAAG,WAAW,CAAC;QAC3C,MAAM,UAAU,GAAG,UAAU,GAAG,WAAW,CAAC;QAC5C,IAAI,SAAS,GAAG,IAAI,CAAC;;QAErB,IAAI,aAAa,GAAG,CAAC,CAAC;QACtB,IAAI,SAAS,GAAG,EAAE,CAAC;;QAEnB,KAAK,IAAI,KAAK,IAAI,MAAM,EAAE;YACtB,KAAK,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,EAAE;gBAC9B,IAAI,CAAC,SAAS,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE;oBAC/B,SAAS,GAAG,EAAE,CAAC;oBACf,KAAK,IAAI,OAAO,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE;wBACjC,SAAS,GAAG,SAAS,GAAG,iBAAiB,GAAG,OAAO,GAAG,IAAI,GAAG,GAAG,GAAG,OAAO,GAAG,QAAO;qBACvF,AACrB,iBAAiB;;gBAED,IAAI,MAAM,CAAC,GAAG,KAAK,UAAU,EAAE;oBAC3B,EAAE,aAAa,CAAC;oBAChB,IAAI,aAAa,CAAC,CAAC,GAAG,UAAU,EAAE,SAAS;oBAC3C,IAAI,aAAa,GAAG,UAAU,EAAE,SAAS;;;oBAGzC,IAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;oBAC/C,MAAM,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,cAAc,GAAG,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,cAAc,GAAG,CAAC,CAAC;oBACpG,MAAM,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;oBACpJ,IAAI,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;oBACxD,UAAU,CAAC,SAAS,GAAG,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS;wBACnD,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;oBACjE,mBAAmB,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;iBAC/C,MAAM,IAAI,MAAM,CAAC,GAAG,KAAK,MAAM,EAAE;oBAC9B,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;iBAChC,MAAM,IAAI,MAAM,CAAC,GAAG,KAAK,OAAO,EAAE;oBAC/B,EAAE,aAAa,CAAC;oBAChB,IAAI,aAAa,CAAC,CAAC,GAAG,UAAU,EAAE,SAAS;oBAC3C,IAAI,aAAa,GAAG,UAAU,EAAE,SAAS;;oBAEzC,IAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;oBAC/C,UAAU,CAAC,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS;wBAChD,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,cAAc,CAAC,CAAC,CAAC;oBAC1G,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;iBACvC;aACJ;YACD,SAAS,GAAG,IAAI,CAAC;SACpB;;QAED,SAAS,GAAG,EAAE,CAAC;QACf,KAAK,IAAI,OAAO,IAAI,SAAS,EAAE;YAC3B,SAAS,GAAG,SAAS,GAAG,iBAAiB,GAAG,OAAO,GAAG,IAAI,GAAG,GAAG,GAAG,OAAO,GAAG,QAAO;SACvF,AACT,QAAQ,eAAe,CAAC,SAAS,GAAG,SAAS,CAAC;;QAEtC,IAAI,KAAK,GAAG,aAAa,GAAG,WAAW,CAAC;QACxC,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,EAAE,CAAC,EAAE;gBAC5B,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;gBACzC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;gBACnB,IAAI,CAAC,IAAI,SAAS,EAAE;oBAChB,IAAI,CAAC,IAAI,GAAG,KAAK,GAAG,CAAC,GAAG,WAAW,CAAC;oBACpC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK;wBAClB,CAAC,CAAC,cAAc,EAAE,CAAC;wBACnB,CAAC,CAAC,eAAe,EAAE,CAAC;wBACpB,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;wBAChF,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,WAAW,EAAE,CAAC,EAAE,WAAW,EAAE,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;sBAClH;iBACJ;gBACD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;gBAC5C,gBAAgB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;aACtC;SACJ;KACJ;;IAED,IAAI,GAAG;QACH,IAAI,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC;;QAElE,MAAM,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;QAC3D,eAAe,CAAC,SAAS,GAAG,CAAC;;;;;QAK7B,CAAC,CAAC;;QAEF,IAAI,CAAC,MAAM,EAAE;YACT,OAAO,CAAC,IAAI,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC;YAC9C,OAAO;SACV;QACD,IAAI,CAAC,eAAe,EAAE;YAClB,OAAO,CAAC,IAAI,CAAC,4BAA4B,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;YACtD,OAAO;SACV;;QAED,MAAM,KAAK,GAAG,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,EAAE;YACR,OAAO,CAAC,IAAI,CAAC,yBAAyB,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;YACnD,OAAO;SACV;;;QAGD,IAAI,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;QACzC,IAAI,CAAC,OAAO,GAAG,IAAI,OAAO,CAAC,MAAM,EAAE,eAAe,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;;QAE5E,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC;QACpB,MAAM,CAAC,QAAQ,GAAG,CAAC,CAAC,KAAK;YACrB,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,CAAC,CAAC,eAAe,EAAE,CAAC;YACpB,OAAO,KAAK,CAAC;UAChB;QACD,MAAM,UAAU,GAAG,CAAC,CAAC;QACrB,KAAK,CAAC,SAAS,GAAG,MAAM;YACpB,MAAM,CAAC,qBAAqB,CAAC,MAAM;gBAC/B,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;aACvB,EAAC;SACL,CAAC;QACF,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK;YACnB,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;YACpB,IAAI,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;YACrE,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;YAC1E,MAAM,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,sBAAsB,CAAC,CAAC;YACnF,MAAM,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,0BAA0B,CAAC,CAAC;YAC3F,MAAM,gBAAgB,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;YACrF,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;YAChF,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnB,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,UAAU,EAAE,CAAC,EAAE,WAAW,EAAE,eAAe,EAAE,mBAAmB,EAAE,gBAAgB,CAAC,CAAC;aACjH,MAAM,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,EAAE;gBAChC,WAAW,CAAC,SAAS,GAAG,CAAC,sDAAsD,EAAC;aACnF;YACD,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC;UACtC;KACJ;;IAED,MAAM,iBAAiB,GAAG;QACtB,IAAI,KAAK,GAAG,EAAE,CAAC;QACf,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,KAAK,GAAG,GAAG,EAAE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QACxE,IAAI,GAAG,GAAG,MAAM,CAAC,wCAAiB,CAAC,CAAC;QACpC,IAAI,SAAS,GAAG,MAAM,KAAK,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QACjD,IAAI,IAAI,GAAG,MAAM,GAAG,CAAC;QACrB,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QACtB,SAAS,GAAG,MAAM,SAAS,CAAC,IAAI,EAAE,CAAC;QACnC,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;QAC7C,IAAI,CAAC,IAAI,EAAE,CAAC;KACf;IACD,oBAAoB,GAAG;QACnB,IAAI,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;KAC5C;CACJ,CAAC,CAAC"}