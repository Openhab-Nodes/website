{"version":3,"file":"interactive_interconnect.js","sources":["../../../assets/js/interactive_interconnect/index.js"],"sourcesContent":["const numSocket = new Rete.Socket('Number value');\nclass WallSwitchCmp extends Rete.Component {\n    constructor() {\n        super('WallSwitchCmp');\n    }\n\n    builder(node) {\n        let out = new Rete.Output('num', 'On/Off', numSocket);\n        node.data.title = \"<span>Wall Switch<br><small style='text-align: right;display:block'>ZWave-129</small></span>\";\n        node.addOutput(out);\n    }\n}\nclass BedroomCeilingCmp extends Rete.Component {\n    constructor() {\n        super('BedroomCeilingCmp');\n    }\n\n    builder(node) {\n        let inp = new Rete.Input('num', 'Brightness', numSocket);\n        node.data.title = \"<span>Bedroom Ceiling<br><small style='text-align: right;display:block'>Hue Bridge</small></span>\";\n        node.addInput(inp);\n    }\n}\n\n\nvar Stage0NumControl = {\n    template: '<div class=\"controlrender\"><span>Duration:</span><span class=\"controlvalue\">5 sec</span><span>Delay:</span><span class=\"controlvalue\">0 sec</span></div>',\n    data() {\n        return {\n            value: 0\n        };\n    },\n    methods: {\n        update() {\n            if (this.root) {\n                this.putData(this.ikey, +this.root.value);\n            }\n\n            this.emitter.trigger(\"process\");\n        }\n    },\n    mounted() {\n    }\n};\n\nclass NumControl extends Rete.Control {\n    constructor(emitter, key, readonly) {\n        super(key);\n        this.component = Stage0NumControl;\n        this.props = { emitter, ikey: key, readonly };\n    }\n\n    setValue(val) {\n        this.stage0Context.root.value = val; // TODO get rid of stage0Context\n    }\n}\n\nclass DimmerCmp extends Rete.Component {\n    constructor() {\n        super('DimmerCmp');\n    }\n\n    builder(node) {\n        node.data.title = \"<span>Dimmer<br><small style='text-align: right;display:block'>Link Processor #62ae34</small></span>\";\n        let inp = new Rete.Input('num', 'On/Off', numSocket);\n        let out = new Rete.Output('num', 'DimmedValue', numSocket);\n        node.addOutput(out);\n        node.addInput(inp);\n        node.addControl(new NumControl(this.editor, \"num\"));\n    }\n}\n\nwindow.customElements.define('ui-interactive-interconnect', class extends HTMLElement {\n    constructor() {\n        super();\n        this.initCb = () => this.init();\n    }\n\n    init() {\n        let container = document.getElementById(this.getAttribute(\"target\"));\n        console.warn(\"Target found!\");\n        if (!container) {\n            console.warn(\"Target not found!\");\n            return;\n        }\n\n        const editor = new Rete.NodeEditor('demo@0.1.0', container);\n        this.editor = editor;\n    \n        editor.use(ConnectionPlugin.default)\n        editor.use(Stage0RenderPlugin)\n    \n        const c1 = new WallSwitchCmp();\n        editor.register(c1);\n        const c2 = new BedroomCeilingCmp();\n        editor.register(c2);\n        const c3 = new DimmerCmp();\n        editor.register(c3);\n    \n        // editor.on('zoom', node => {\n        //     console.log(editor.toJSON());\n        //     return false;\n        // });\n    \n        const data = {\n            \"id\": \"demo@0.1.0\",\n            \"nodes\": { \"1\": { \"id\": 1, \"data\": { \"num\": 1 }, \"inputs\": {}, \"outputs\": { \"num\": { \"connections\": [{ \"node\": 2, \"input\": \"num\", \"data\": {} }] } }, \"position\": [7, 8], \"name\": \"WallSwitchCmp\" }, \"2\": { \"id\": 2, \"data\": { \"num\": 1 }, \"inputs\": { \"num\": { \"connections\": [{ \"node\": 1, \"output\": \"num\", \"data\": {} }] } }, \"outputs\": { \"num\": { \"connections\": [{ \"node\": 3, \"input\": \"num\", \"data\": {} }] } }, \"position\": [202, 64], \"name\": \"DimmerCmp\" }, \"3\": { \"id\": 3, \"data\": { \"num\": 1 }, \"inputs\": { \"num\": { \"connections\": [{ \"node\": 2, \"output\": \"num\", \"data\": {} }] } }, \"outputs\": {}, \"position\": [443, 246], \"name\": \"BedroomCeilingCmp\" } }\n        };\n        editor.fromJSON(data);\n    }\n    \n    connectedCallback() {\n        document.addEventListener(\"MainContentChanged\", this.initCb);\n    }\n    disconnectedCallback() {\n        document.removeEventListener(\"MainContentChanged\", this.initCb);\n    }\n});\n"],"names":[],"mappings":"AAAA,MAAM,SAAS,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;AAClD,MAAM,aAAa,SAAS,IAAI,CAAC,SAAS,CAAC;IACvC,WAAW,GAAG;QACV,KAAK,CAAC,eAAe,CAAC,CAAC;KAC1B;;IAED,OAAO,CAAC,IAAI,EAAE;QACV,IAAI,GAAG,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;QACtD,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,8FAA8F,CAAC;QACjH,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;KACvB;CACJ;AACD,MAAM,iBAAiB,SAAS,IAAI,CAAC,SAAS,CAAC;IAC3C,WAAW,GAAG;QACV,KAAK,CAAC,mBAAmB,CAAC,CAAC;KAC9B;;IAED,OAAO,CAAC,IAAI,EAAE;QACV,IAAI,GAAG,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,YAAY,EAAE,SAAS,CAAC,CAAC;QACzD,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,mGAAmG,CAAC;QACtH,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;KACtB;CACJ;;;AAGD,IAAI,gBAAgB,GAAG;IACnB,QAAQ,EAAE,0JAA0J;IACpK,IAAI,GAAG;QACH,OAAO;YACH,KAAK,EAAE,CAAC;SACX,CAAC;KACL;IACD,OAAO,EAAE;QACL,MAAM,GAAG;YACL,IAAI,IAAI,CAAC,IAAI,EAAE;gBACX,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAC7C;;YAED,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;SACnC;KACJ;IACD,OAAO,GAAG;KACT;CACJ,CAAC;;AAEF,MAAM,UAAU,SAAS,IAAI,CAAC,OAAO,CAAC;IAClC,WAAW,CAAC,OAAO,EAAE,GAAG,EAAE,QAAQ,EAAE;QAChC,KAAK,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,SAAS,GAAG,gBAAgB,CAAC;QAClC,IAAI,CAAC,KAAK,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,CAAC;KACjD;;IAED,QAAQ,CAAC,GAAG,EAAE;QACV,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;KACvC;CACJ;;AAED,MAAM,SAAS,SAAS,IAAI,CAAC,SAAS,CAAC;IACnC,WAAW,GAAG;QACV,KAAK,CAAC,WAAW,CAAC,CAAC;KACtB;;IAED,OAAO,CAAC,IAAI,EAAE;QACV,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,sGAAsG,CAAC;QACzH,IAAI,GAAG,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;QACrD,IAAI,GAAG,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,aAAa,EAAE,SAAS,CAAC,CAAC;QAC3D,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;QACpB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QACnB,IAAI,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC;KACvD;CACJ;;AAED,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,6BAA6B,EAAE,cAAc,WAAW,CAAC;IAClF,WAAW,GAAG;QACV,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,MAAM,GAAG,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;KACnC;;IAED,IAAI,GAAG;QACH,IAAI,SAAS,GAAG,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC;QACrE,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC9B,IAAI,CAAC,SAAS,EAAE;YACZ,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAClC,OAAO;SACV;;QAED,MAAM,MAAM,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;QAC5D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;QAErB,MAAM,CAAC,GAAG,CAAC,gBAAgB,CAAC,OAAO,EAAC;QACpC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAC;;QAE9B,MAAM,EAAE,GAAG,IAAI,aAAa,EAAE,CAAC;QAC/B,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QACpB,MAAM,EAAE,GAAG,IAAI,iBAAiB,EAAE,CAAC;QACnC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QACpB,MAAM,EAAE,GAAG,IAAI,SAAS,EAAE,CAAC;QAC3B,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;;;;;;;QAOpB,MAAM,IAAI,GAAG;YACT,IAAI,EAAE,YAAY;YAClB,OAAO,EAAE,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,KAAK,EAAE,EAAE,aAAa,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,EAAE,eAAe,EAAE,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,KAAK,EAAE,EAAE,aAAa,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,KAAK,EAAE,EAAE,aAAa,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,UAAU,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,KAAK,EAAE,EAAE,aAAa,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,MAAM,EAAE,mBAAmB,EAAE,EAAE;SACzoB,CAAC;QACF,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KACzB;;IAED,iBAAiB,GAAG;QAChB,QAAQ,CAAC,gBAAgB,CAAC,oBAAoB,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KAChE;IACD,oBAAoB,GAAG;QACnB,QAAQ,CAAC,mBAAmB,CAAC,oBAAoB,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KACnE;CACJ,CAAC,CAAC"}