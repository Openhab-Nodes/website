{"version":3,"file":"interactive_interconnect.js","sources":["../../../assets/js/interactive_interconnect/index.js"],"sourcesContent":["const numSocket = new Rete.Socket('Number value');\nclass WallSwitchCmp extends Rete.Component {\n    constructor() {\n        super('WallSwitchCmp');\n    }\n\n    builder(node) {\n        let out = new Rete.Output('num', 'On/Off', numSocket);\n        node.data.title = \"<span>Wall Switch<br><small style='text-align: right;display:block'>ZWave-129</small></span>\";\n        node.addOutput(out);\n    }\n}\nclass BedroomCeilingCmp extends Rete.Component {\n    constructor() {\n        super('BedroomCeilingCmp');\n    }\n\n    builder(node) {\n        let inp = new Rete.Input('num', 'Brightness', numSocket);\n        node.data.title = \"<span>Bedroom Ceiling<br><small style='text-align: right;display:block'>Hue Bridge</small></span>\";\n        node.addInput(inp);\n    }\n}\n\n\nvar Stage0NumControl = {\n    template: '<div class=\"controlrender\"><span>Duration:</span><span class=\"controlvalue\">5 sec</span><span>Delay:</span><span class=\"controlvalue\">0 sec</span></div>',\n    data() {\n        return {\n            value: 0\n        };\n    },\n    methods: {\n        update() {\n            if (this.root) {\n                this.putData(this.ikey, +this.root.value);\n            }\n\n            this.emitter.trigger(\"process\");\n        }\n    },\n    mounted() {\n    }\n};\n\nclass NumControl extends Rete.Control {\n    constructor(emitter, key, readonly) {\n        super(key);\n        this.component = Stage0NumControl;\n        this.props = { emitter, ikey: key, readonly };\n    }\n\n    setValue(val) {\n        this.stage0Context.root.value = val; // TODO get rid of stage0Context\n    }\n}\n\nclass DimmerCmp extends Rete.Component {\n    constructor() {\n        super('DimmerCmp');\n    }\n\n    builder(node) {\n        node.data.title = \"<span>Dimmer<br><small style='text-align: right;display:block'>Link Processor #62ae34</small></span>\";\n        let inp = new Rete.Input('num', 'On/Off', numSocket);\n        let out = new Rete.Output('num', 'DimmedValue', numSocket);\n        node.addOutput(out);\n        node.addInput(inp);\n        node.addControl(new NumControl(this.editor, \"num\"));\n    }\n}\n\nwindow.customElements.define('ui-interactive-interconnect', class extends HTMLElement {\n    constructor() {\n        super();\n        this.initCb = () => this.init();\n    }\n\n    init() {\n        let container = document.getElementById(this.getAttribute(\"target\"));\n        console.warn(\"Target found!\");\n        if (!container) {\n            console.warn(\"Target not found!\");\n            return;\n        }\n\n        const editor = new Rete.NodeEditor('demo@0.1.0', container);\n        this.editor = editor;\n    \n        editor.use(ConnectionPlugin.default)\n        editor.use(Stage0RenderPlugin)\n    \n        const c1 = new WallSwitchCmp();\n        editor.register(c1);\n        const c2 = new BedroomCeilingCmp();\n        editor.register(c2);\n        const c3 = new DimmerCmp();\n        editor.register(c3);\n    \n        // editor.on('zoom', node => {\n        //     console.log(editor.toJSON());\n        //     return false;\n        // });\n    \n        const data = {\n            \"id\": \"demo@0.1.0\",\n            \"nodes\": { \"1\": { \"id\": 1, \"data\": { \"num\": 1 }, \"inputs\": {}, \"outputs\": { \"num\": { \"connections\": [{ \"node\": 2, \"input\": \"num\", \"data\": {} }] } }, \"position\": [7, 8], \"name\": \"WallSwitchCmp\" }, \"2\": { \"id\": 2, \"data\": { \"num\": 1 }, \"inputs\": { \"num\": { \"connections\": [{ \"node\": 1, \"output\": \"num\", \"data\": {} }] } }, \"outputs\": { \"num\": { \"connections\": [{ \"node\": 3, \"input\": \"num\", \"data\": {} }] } }, \"position\": [202, 64], \"name\": \"DimmerCmp\" }, \"3\": { \"id\": 3, \"data\": { \"num\": 1 }, \"inputs\": { \"num\": { \"connections\": [{ \"node\": 2, \"output\": \"num\", \"data\": {} }] } }, \"outputs\": {}, \"position\": [443, 246], \"name\": \"BedroomCeilingCmp\" } }\n        };\n        editor.fromJSON(data);\n    }\n    \n    connectedCallback() {\n        document.addEventListener(\"MainContentChanged\", this.initCb);\n    }\n    disconnectedCallback() {\n        document.removeEventListener(\"MainContentChanged\", this.initCb);\n    }\n});\n"],"names":["numSocket","Rete","Socket","WallSwitchCmp","Component","[object Object]","super","node","out","Output","data","title","addOutput","BedroomCeilingCmp","inp","Input","addInput","Stage0NumControl","template","value","methods","this","root","putData","ikey","emitter","trigger","NumControl","Control","key","readonly","component","props","val","stage0Context","DimmerCmp","addControl","editor","window","customElements","define","HTMLElement","initCb","init","container","document","getElementById","getAttribute","console","warn","NodeEditor","use","ConnectionPlugin","default","Stage0RenderPlugin","c1","register","c2","c3","fromJSON","id","nodes","1","num","inputs","outputs","connections","input","position","name","2","output","3","addEventListener","removeEventListener"],"mappings":"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"}