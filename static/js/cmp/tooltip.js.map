{"version":3,"file":"tooltip.js","sources":["../../../assets/js/tooltip/popover_helper.js","../../../assets/js/tooltip/index.js"],"sourcesContent":["\nfunction isInViewport(element) {\n  const rect = element.getBoundingClientRect();\n  const html = document.documentElement;\n  return rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= (window.innerHeight || html.clientHeight) &&\n    rect.right <= (window.innerWidth || html.clientWidth);\n}\n\nclass Popover {\n  constructor(trigger, popoverTemplate, { position = 'top', className = 'popover' }, doc = document) {\n    this.trigger = trigger;\n    this.position = position;\n    this.className = className;\n    this.orderedPositions = ['top', 'right', 'bottom', 'left'];\n    this.popover = popoverTemplate;\n\n    this.handleWindowEvent = () => {\n      if (this.isVisible) {\n        this.reposition();\n      }\n    };\n\n    this.handleDocumentEvent = (evt) => {\n      if (this.isVisible && evt.target !== this.trigger && evt.target !== this.popover) {\n        this.destroy();\n      }\n    };\n  }\n\n  get isVisible() {\n    return this.popover.classList.contains(this.className);\n  }\n\n  show() {\n    if (this.isVisible) return;\n\n    document.addEventListener('click', this.handleDocumentEvent);\n    window.addEventListener('scroll', this.handleWindowEvent);\n    window.addEventListener('resize', this.handleWindowEvent);\n    this.reposition();\n  }\n\n  reposition() {\n    const { top: triggerTop, left: triggerLeft } = this.trigger.getBoundingClientRect();\n    const { offsetHeight: triggerHeight, offsetWidth: triggerWidth } = this.trigger;\n    const { offsetHeight: popoverHeight, offsetWidth: popoverWidth } = this.popover;\n\n    const positionIndex = this.orderedPositions.indexOf(this.position);\n\n    const positions = {\n      top: {\n        name: 'top',\n        top: triggerTop - popoverHeight,\n        left: triggerLeft - ((popoverWidth - triggerWidth) / 2)\n      },\n      right: {\n        name: 'right',\n        top: triggerTop - ((popoverHeight - triggerHeight) / 2),\n        left: triggerLeft + triggerWidth\n      },\n      bottom: {\n        name: 'bottom',\n        top: triggerTop + triggerHeight,\n        left: triggerLeft - ((popoverWidth - triggerWidth) / 2)\n      },\n      left: {\n        name: 'left',\n        top: triggerTop - ((popoverHeight - triggerHeight) / 2),\n        left: triggerLeft - popoverWidth\n      }\n    };\n\n    const position = this.orderedPositions\n      .slice(positionIndex)\n      .concat(this.orderedPositions.slice(0, positionIndex))\n      .map(pos => positions[pos])\n      .find(pos => {\n        this.popover.style.top = `${pos.top}px`;\n        this.popover.style.left = `${pos.left}px`;\n        return isInViewport(this.popover);\n      });\n\n    this.orderedPositions.forEach(pos => {\n      this.popover.classList.remove(`${this.className}--${pos}`);\n    });\n\n    if (position) {\n      this.popover.classList.add(`${this.className}--${position.name}`);\n    } else {\n      this.popover.style.top = positions.bottom.top;\n      this.popover.style.left = positions.bottom.left;\n      this.popover.classList.add(`${this.className}--bottom`);\n    }\n    this.popover.classList.add(this.className);\n  }\n\n  destroy() {\n    this.orderedPositions.forEach(pos => {\n      this.popover.classList.remove(`${this.className}--${pos}`);\n    });\n    this.popover.classList.remove(`${this.className}`);\n\n    document.removeEventListener('click', this.handleDocumentEvent);\n    window.removeEventListener('scroll', this.handleWindowEvent);\n    window.removeEventListener('resize', this.handleWindowEvent);\n  }\n\n  toggle() {\n    if (this.isVisible) {\n      this.destroy();\n    } else {\n      this.show();\n    }\n  }\n}\n\nexport { Popover };","import { Popover } from \"./popover_helper.js\";\n\n/**\n * Usage:\n * \n * With external button:\n * <button id=\"mybutton\" class=\"contexthelp\">Click here</button>\n * <ui-tooltip target=\"mybutton\">\n *   <div>Some content</div>\n * </ui-tooltip>\n * \n * With inline button\n * <ui-tooltip>\n *   <button class=\"btn-link contexthelp\" title=\"Context help\" slot=\"button\">Click here</button>\n *   <div>Some content</div>\n * </ui-tooltip>\n */\nwindow.customElements.define('ui-tooltip', class extends HTMLElement {\n  constructor() {\n    super();\n    this.clickCb = e => this.click(e);\n    this.attachShadow({mode: 'open'}).innerHTML=\"<link rel='stylesheet' href='/css/main.min.css'><div style='position:fixed;visibility:hidden;z-index:100' id='main'><slot></slot></div><slot name='button'></slot>\";\n  }\n\n  click(e) {\n    if (e) {\n      e.preventDefault();\n      e.stopPropagation();\n      }\n    this.popover.toggle();\n  }\n\n  connectedCallback() {\n    window.requestAnimationFrame(()=> this.connectedCallbackDelayed());\n  }\n\n  connectedCallbackDelayed() {\n    const defaultSlot = this.shadowRoot.querySelector('#main');\n    if (this.hasAttribute(\"maxwidth\")) defaultSlot.style.maxWidth= \"500px\";\n\n    let trigger = this.hasAttribute(\"target\")? document.getElementById(this.getAttribute(\"target\")):null;\n\n    if (this.popover) this.popover.destroy();\n\n    this.popover = new Popover(trigger||this, defaultSlot, { position: 'bottom' });\n    if (!trigger) trigger = this.shadowRoot.querySelector('slot[name=\"button\"]');\n    if (trigger) {\n      trigger.removeEventListener('click', this.clickCb);\n      trigger.addEventListener('click', this.clickCb);\n    }\n  }\n  disconnectedCallback() {\n    if (this.popover) this.popover.destroy();\n    delete this.popover;\n    const trigger = document.getElementById(this.getAttribute(\"target\"));\n    if (trigger) trigger.removeEventListener('click', this.clickCb);\n  }\n});\n"],"names":["Popover","[object Object]","trigger","popoverTemplate","position","className","doc","document","this","orderedPositions","popover","handleWindowEvent","isVisible","reposition","handleDocumentEvent","evt","target","destroy","classList","contains","addEventListener","window","top","triggerTop","left","triggerLeft","getBoundingClientRect","offsetHeight","triggerHeight","offsetWidth","triggerWidth","popoverHeight","popoverWidth","positionIndex","indexOf","positions","name","right","bottom","slice","concat","map","pos","find","style","element","rect","html","documentElement","innerHeight","clientHeight","innerWidth","clientWidth","isInViewport","forEach","remove","add","removeEventListener","show","customElements","define","HTMLElement","super","clickCb","e","click","attachShadow","mode","innerHTML","preventDefault","stopPropagation","toggle","requestAnimationFrame","connectedCallbackDelayed","defaultSlot","shadowRoot","querySelector","hasAttribute","maxWidth","getElementById","getAttribute"],"mappings":"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"}